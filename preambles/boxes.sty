\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{boxes}
\RequirePackage{amsthm}
\RequirePackage{kvoptions}
\RequirePackage[many]{tcolorbox}

\SetupKeyvalOptions{
    family=ptkyr,
    prefix=ptkyr@
}

\DeclareBoolOption[true]{boxed}
\DeclareBoolOption[false]{dark}

\ProcessKeyvalOptions*

% Theorems/proofs
\newtheoremstyle{bfit}%      % Name
  {2pt}%                        % Space above
  {2pt}%                        % Space below
  {}%                           % Body font (empty for upright)
  {}%                           % Indent amount
  {\itshape\bfseries}%          % Theorem head font
  {.}%                          % Punctuation after theorem head
  {0.5em}%                      % Space after theorem head, ' ', or \newline
  {}%                           % Theorem head spec (can be left empty, meaning `normal')
\theoremstyle{plain}
\newtheorem{thm}{Theorem}[section]
\newtheorem{subthm}{Theorem}[subsection]
\newtheorem{subprop}[subthm]{Proposition}
\newtheorem{prop}[thm]{Proposition}
\newtheorem{cor}[thm]{Corollary}
\newtheorem{subcor}[subthm]{Corollary}
\newtheorem{lemma}[thm]{Lemma}
\newtheorem{sublemma}[subthm]{Lemma}
\theoremstyle{definition}
\newtheorem{defn}[thm]{Definition}
\newtheorem{subdefn}[subthm]{Definition}
\theoremstyle{remark}           % This is a default style I think
\newtheorem*{notn}{Notation}
\newtheorem*{conv}{Convention}
\newtheorem*{warn}{Warning}
\newtheorem*{aside}{Aside}
\theoremstyle{bfit}          % Things I actually use
\newtheorem*{remk}{Remark}
\newtheorem*{ques}{Question}
\newtheorem*{exer}{Exercise}
\newtheorem*{exmp}{Example}
\newtheorem*{cex}{Counterexample}

% Everything below here is for defn/thm/lemma/prop

% Colours
\definecolor{defncol}{HTML}{a0a0a0} 
\definecolor{thmcol}{HTML}{00668f} 
\definecolor{lemmcol}{HTML}{a3006f} 
\definecolor{propcol}{HTML}{00855d} 
\definecolor{corcol}{HTML}{5488e3} 

% Box Theorems
\tcbset{
    ptkyrbox/.style={
        width=\textwidth,
        boxrule=1pt,
        boxsep=1pt,
        colback=white!0,
        sharp corners,
        breakable,
        enhanced,
        fonttitle=\bfseries,
        boxed title style={sharp corners},
        attach boxed title to top left
    }
}
\newtcbtheorem[number within=section]{btheoremi}{Theorem}{
    ptkyrbox,
    colframe=thmcol,
    colbacktitle=thmcol
}{btheoremi}
\newtcbtheorem[use counter from=btheoremi]{bdefinitioni}{Definition}{
    ptkyrbox,
    colframe=defncol,
    colbacktitle=defncol,
}{bdefinitioni}
\newtcbtheorem[use counter from=btheoremi]{blemmai}{Lemma}{
    ptkyrbox,
    colframe=lemmcol,
    colbacktitle=lemmcol,
}{blemmai}
\newtcbtheorem[use counter from=btheoremi]{bpropositioni}{Proposition}{
    ptkyrbox,
    colframe=propcol,
    colbacktitle=propcol,
}{bpropositioni}
\newtcbtheorem[use counter from=btheoremi]{bcorollaryi}{Corollary}{
    ptkyrbox,
    colframe=corcol,
    colbacktitle=corcol,
}{bcorollaryi}
    
% Options
\ifptkyr@boxed
\renewenvironment{thm}[1]
    {\begin{btheoremi}{#1}{}}
    {\end{btheoremi}}
\renewenvironment{defn}[1]
    {\begin{bdefinitioni}{#1}{}}
    {\end{bdefinitioni}}
\renewenvironment{lemma}[1]
    {\begin{blemmai}{#1}{}}
    {\end{blemmai}}
\renewenvironment{prop}[1]
    {\begin{bpropositioni}{#1}{}}
    {\end{bpropositioni}}
\renewenvironment{cor}[1]
    {\begin{bcorollaryi}{#1}{}}
    {\end{bcorollaryi}}
\fi

\ifptkyr@dark
\definecolor{defncol}{HTML}{ed4700} 
\definecolor{thmcol}{HTML}{000080} 
\definecolor{lemmcol}{HTML}{990000} 
\definecolor{propcol}{HTML}{71169e} 
\fi

\allowdisplaybreaks
\endinput
